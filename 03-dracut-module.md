## 3. –î–æ–±–∞–≤–∏—Ç—å `dracut` –º–æ–¥—É–ª—åüêß –≤ `initrd`

> –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è `initrd` —Å –ø–æ–º–æ—â—å—é `dracut`  —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –∏–∑ –º–æ–¥—É–ª–µ–π.
> –°–∫—Ä–∏–ø—Ç—ã –º–æ–¥—É–ª–µ–π —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –∫–∞—Ç–∞–ª–æ–≥–µ `/usr/lib/dracut/modules.d/`

### –ë—É–¥–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω –Ω–æ–≤—ã–π –º–æ–¥—É–ª—å `test`.

–°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –∫–∞—Ç–∞–ª–æ–≥ –¥–ª—è –º–æ–¥—É–ª—è –∏ –ø–µ—Ä–µ–π—Ç–∏ –≤ –Ω–µ–≥–æ.
```php
[root@linux]# mkdir /usr/lib/dracut/modules.d/01test  && cd "$_"
```
__–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª—ã –º–æ–¥—É–ª—è `test`:__
```php
[root@linux]# vi module-setup.sh
#!/bin/bash

check() {
    return 0
}

depends() {
    return 0
}

install() {
    inst_hook cleanup 00 "${moddir}/test.sh"
}
```
–°–∫—Ä–∏–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å—Å—è, –≤ –Ω—ë–º —Ä–∏—Å—É–µ—Ç—Å—è üêß–ø–∏–Ω–≥–≤–∏–Ω.
```php
[root@linux]# vi test.sh
#!/bin/bash

exec 0<>/dev/console 1<>/dev/console 2<>/dev/console
cat <<'EOF'
Hello! You are in dracut module!
 ___________________
< I'm dracut module >
 -------------------
   \
    \
        .--.
       |o_o |
       |:_/ |
      //   \ \
     (|     | )
    /'\_   _/`\
    \___)=(___/
EOF
sleep 10
echo " continuing...."
```

–ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑ `initrd`, —á—Ç–æ–±—ã –ø–æ–¥–≥—Ä—É–∑–∏—Ç—å –Ω–æ–≤—ã–π –º–æ–¥—É–ª—å.
```php
[root@linux]# dracut -f -v 
...
*** Creating image file ***
*** Creating image file done ***
*** Creating initramfs image file '/boot/initramfs-3.10.0-862.2.3.el7.x86_64.img' done ***
[root@linux]# 
```
–ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –º–æ–¥—É–ª—å `test` –∑–∞–≥—Ä—É–∂–µ–Ω –≤ –æ–±—Ä–∞–∑ `initrd`
```php
[root@linux]# lsinitrd -m /boot/initramfs-$(uname -r).img | grep te
test
terminfo
systemd
[root@linux]# 
```
–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è.
```php
reboot
```

‚ñ™ –ü–æ—Å–ª–µ —á–µ–≥–æ –º–æ–∂–Ω–æ –ø–æ–π—Ç–∏ –¥–≤—É–º—è –ø—É—Ç—è–º–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:  
    1. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è –∏ –≤ `GRUB2` –≤ —Å—Ç—Ä–æ–∫–µ `linux16` —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ —Å—Ç–µ—Ä–µ—Ç—å –æ–ø—Ü–∏–∏ `rghb` –∏ `quiet` , –¥–∞–ª—å—à–µ `Ctrl+x` –∏ —É–≤–∏–¥–µ—Ç—å –≤—ã–≤–æ–¥.  
    2. –õ–∏–±–æ –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å `grub.cfg` , —á—Ç–æ–±—ã —É–±—Ä–∞—Ç—å —ç—Ç–∏ –æ–ø—Ü–∏–∏ –Ω–∞–≤—Å–µ–≥–¥–∞.  
‚ñ™ –í –∏—Ç–æ–≥–µ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –±—É–¥–µ—Ç –ø–∞—É–∑–∞ –Ω–∞ 10 —Å–µ–∫—É–Ω–¥ —Å –ø–∏–Ω–≥–≤–∏–Ω–æ–º –≤ –≤—ã–≤–æ–¥–µ —Ç–µ—Ä–º–∏–Ω–∞–ª–∞.  
